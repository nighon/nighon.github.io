---
layout: post
title: 'Git track forget methods'
---

`git rm --cached <file>` 和 `git update-index --skip-worktree <file_name>` 都可以实现让 Git 忘记以前跟踪但现在在 .gitignore 中的文件的目标。然而，它们的用途略有不同，并且具有不同的含义，因此它们之间的选择取决于您的特定需求和工作流程。

以下是每种方法的细分：

## git rm --cached

**警告：虽然这不会从本地计算机中删除物理文件，但会在其他开发人员的下一次 `git pull` 时从他的计算机中删除文件。**

此命令从索引（暂存区域）中删除指定的文件，同时将其保留在工作目录中。它有效地停止跟踪文件，而不将其从文件系统中删除。
该文件将不再包含在以后的提交中，Git 将不再跟踪对其所做的更改。如果您想从存储库（包括历史记录）中完全删除该文件，您需要跟进提交并推送以使更改永久化。

根据文件 `.gitignore` 的内容批量删除：

`grep -v '^#' .gitignore | grep -v '^$' | xargs -I {} git rm --cached {}`

## git update-index --skip-worktree

此命令告诉 Git 忽略对工作目录中指定文件的更改。它不会从索引或跟踪中删除文件； 相反，它将文件标记为“skip-worktree”，这意味着 Git 不会在本地更新它。如果您希望将文件保留在存储库中并在存储库的其他克隆上更新它，但您希望对其进行本地更改而不影响存储库的版本，那么这非常有用。与 git rm --cached 不同，此命令不会影响提交到存储库的内容。如果文件被修改并暂存，这些更改仍将包含在提交中，除非您显式重置跳过工作树位。

## 就“最佳实践”而言，这取决于您的具体用例：

- 如果您想完全停止跟踪文件并将其从将来的提交中删除，那么 `git rm --cached` 是合适的选择。
- 如果您想将文件保留在存储库中但避免意外提交本地更改，那么 `git update-index --skip-worktree` 更合适。
